{"is_source_file": true, "format": "bash script", "description": "This file is a Bash script used for managing database schema migrations, version tracking, and related setup tasks for a PostgreSQL database. It contains functions to check database connectivity, list and apply migrations, as well as setup routines for creating migration templates.", "external_files": ["/usr/lib/postgresql/", "/usr/lib/postgresql/${PG_VERSION}/bin", "migrations/", "uuid_generate_v4()", "update_updated_at_column()", "system_logs"], "external_methods": ["psql", "pg_isready"], "published": [], "classes": [], "methods": [{"name": "check_database", "description": "Checks if PostgreSQL is running and the target database exists."}, {"name": "get_current_version", "description": "Retrieves the latest schema version from the schema_migrations table."}, {"name": "list_migrations", "description": "Lists all available migration files in the migrations directory."}, {"name": "apply_migration", "description": "Applies a specific migration SQL file and records its application."}, {"name": "setup_migrations", "description": "Creates the migrations directory and populates it with a sample migration file."}, {"name": "show_usage", "description": "Displays usage instructions and command options."}], "calls": ["ls /usr/lib/postgresql/", "${PG_BIN}/pg_isready", "${PG_BIN}/psql", "cut -d | -f 1", "grep -qw ${DB_NAME}", "PGPASSWORD=\"${DB_PASSWORD}\" ${PG_BIN}/psql -c \"SELECT version ...\"", "mkdir -p \"$MIGRATIONS_DIR\"", "cat > \"$MIGRATIONS_DIR/001_add_user_preferences.sql\" << 'EOF'", "psql -f \"$migration_file\"", "pg_isready", "psql -c \"SELECT COUNT(*) FROM schema_migrations ...\""], "search-terms": ["database migration", "schema versioning", "migration scripts", "PostgreSQL schema upgrade", "migrate.sh", "migration directory", "apply migration", "database setup"], "state": 2, "file_id": 15, "knowledge_revision": 35, "git_revision": "", "hash": "5479b17db9cda88dce32c6e828219f6a", "format-version": 4, "code-base-name": "blablabil_database", "filename": "blablabil_database/migrate.sh", "revision_history": [{"35": ""}]}